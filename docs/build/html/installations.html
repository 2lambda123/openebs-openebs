
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installations and configurations &#8212; OpenEBS 0.0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">OpenEBS 0.0.2 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installations-and-configurations">
<span id="getting-started"></span><h1>Installations and configurations<a class="headerlink" href="#installations-and-configurations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installing-from-binaries">
<span id="installing-docdir"></span><h2>Installing from binaries<a class="headerlink" href="#installing-from-binaries" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-maya">
<h3>Install Maya<a class="headerlink" href="#install-maya" title="Permalink to this headline">¶</a></h3>
<p>maya is a single binary that will be installed on both OpenEBS Maya Master (OMM) and OpenEBS Storage Host (OSH) machines. Maya can then be used to configure the machine either as omm or osh. Maya will pull in the dependencies from github or dockerhub. OpenEBS binary (maya) releases are maintained in github at <a class="reference external" href="https://github.com/openebs/maya/releases">https://github.com/openebs/maya/releases</a></p>
<p>Before proceeding to install maya, verify that wget and unzip packages are installed.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>RELEASE_TAG=0.0.4
wget https://github.com/openebs/maya/releases/download/${RELEASE_TAG}/maya-linux_amd64.zip
unzip maya-linux_amd64.zip
sudo mv maya /usr/bin
rm -rf maya-linux_amd64.zip
maya version
</pre></div>
</div>
</div>
<div class="section" id="setup-openebs-maya-master-omm">
<span id="fetching-the-data"></span><h3>Setup OpenEBS Maya Master (OMM)<a class="headerlink" href="#setup-openebs-maya-master-omm" title="Permalink to this headline">¶</a></h3>
<p>Verify that maya is installed and obtain the Listen IP address for Maya Master. The maya cli will connect to this IP address for scheduling and managing the VSMs.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~$ maya version
Maya v&#39;0.0.4&#39;-dev (&#39;6fe624e3bc71c0b053795939511eff00a18c10f3&#39;)
ubuntu@master-01:~$ ip addr show | grep global
   inet 10.0.2.15/24 brd 10.0.2.255 scope global enp0s3
   inet 172.28.128.8/24 brd 172.28.128.255 scope global enp0s8
ubuntu@master-01:~$ maya version
</pre></div>
</div>
<p>Let us use the 172.28.128.8 as the listen IP address. Configure the machine as OMM with the following instruction.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~$ maya setup-omm -self-ip=172.28.128.8
ubuntu@master-01:~$ source ~/.profile
</pre></div>
</div>
<p>Verify that Maya Master is configured by running the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~$ maya omm-status
Name              Address       Port  Status  Leader  Protocol  Build  Datacenter  Region
master-01.global  172.28.128.8  4648  alive   true    2         0.5.0  dc1         global
ubuntu@master-01:~$
</pre></div>
</div>
</div>
<div class="section" id="setup-openebs-storage-host-osh">
<h3>Setup OpenEBS Storage Host (OSH)<a class="headerlink" href="#setup-openebs-storage-host-osh" title="Permalink to this headline">¶</a></h3>
<p>Verify that maya is installed and obtain the Listen IP address for Maya Master. The maya cli will connect to this IP address for scheduling and managing the VSMs.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@host-01:~$ maya version
Maya v&#39;0.0.4&#39;-dev (&#39;6fe624e3bc71c0b053795939511eff00a18c10f3&#39;)
ubuntu@host-01:~$ ip addr show | grep global
   inet 10.0.2.15/24 brd 10.0.2.255 scope global enp0s3
   inet 172.28.128.9/24 brd 172.28.128.255 scope global enp0s8
ubuntu@host-01:~$
</pre></div>
</div>
<p>Let us use the 172.28.128.9 as the listen IP address and connect to the previously installed Maya Master at 172.28.128.8 Configure the machine as OSH with the following instruction.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@host-01:~$ maya setup-osh -self-ip=172.28.128.9 -omm-ips=172.28.128.8
ubuntu@host-01:~$ source ~/.profile
</pre></div>
</div>
<p>Verify that Storage Host is configured by running the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@host-01:~$ maya osh-status
ID        DC   Name     Class   Drain  Status
dc7fd9b9  dc1  host-01  &lt;none&gt;  false  ready
ubuntu@host-01:~$
</pre></div>
</div>
<p>Repeat the same steps on the host-02 as well.</p>
</div>
<div class="section" id="verify-configuration">
<h3>Verify configuration<a class="headerlink" href="#verify-configuration" title="Permalink to this headline">¶</a></h3>
<p>On successful completion, the omm-status should show one entry and osh-status should have two entries. The output should look like below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~$ maya omm-status
Name              Address       Port  Status  Leader  Protocol  Build  Datacenter  Region
master-01.global  172.28.128.8  4648  alive   true    2         0.5.0  dc1         global
ubuntu@master-01:~$ maya osh-status
ID        DC   Name     Class   Drain  Status
cbceb3d2  dc1  host-02  &lt;none&gt;  false  ready
dc7fd9b9  dc1  host-01  &lt;none&gt;  false  ready
ubuntu@master-01:~$
Next  Previous
</pre></div>
</div>
</div>
</div>
<div class="section" id="installing-from-source">
<h2>Installing from source<a class="headerlink" href="#installing-from-source" title="Permalink to this headline">¶</a></h2>
<p>An OpenEBS Cluster comprises of OpenEBS Maya Masters (omm) for storing the metadata and orchestrating the VSMs on the OpenEBS Storage Hosts (osh). The OpenEBS Storage Hosts typically would either have hard disks/SSDs or mounted file/block/s3 storage that will be used as persistent store.</p>
<p>maya is the only binary that needs to be installed on the machine to turn the machine in to either omm or osh. Maya will pull in the dependencies from githup or dockerhub as required. You need to have the machine connected to internet while running the setup commands.</p>
<div class="section" id="software-requirements">
<h3>Software Requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline">¶</a></h3>
<p>On your machine, ensure the following: - golang is installed. Verify $GOPATH environment variable is set and $GOPATH/bin is included in your $PATH - git is installed for downloading the source - zip and unzip packages are required for creating and distributing the depedencies</p>
</div>
<div class="section" id="download-source-compile-and-install-maya">
<h3>Download Source, Compile and Install maya<a class="headerlink" href="#download-source-compile-and-install-maya" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>mkdir -p $GOPATH/src/github.com/openebs &amp;&amp; cd $GOPATH/src/github.com/openebs
git clone <a class="reference external" href="https://github.com/openebs/maya.git">https://github.com/openebs/maya.git</a>
cd maya &amp;&amp; make dev</div></blockquote>
</div>
<div class="section" id="verify-maya-is-running">
<h3>Verify maya is running<a class="headerlink" href="#verify-maya-is-running" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>maya</div></blockquote>
</div>
<div class="section" id="id1">
<h3>Setup OpenEBS Maya Master (omm)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;master-01">ubuntu<span>&#64;</span>master-01</a>:~$ maya setup-omm -self-ip=172.28.128.3</div></blockquote>
</div>
<div class="section" id="setup-openebs-host-osh">
<h3>Setup OpenEBS Host (osh)<a class="headerlink" href="#setup-openebs-host-osh" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;host-01">ubuntu<span>&#64;</span>host-01</a>:~$ maya setup-osh -self-ip=172.28.128.6 -omm-ips=172.28.128.3</div></blockquote>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="storage-configuration">
<h3>Storage Configuration<a class="headerlink" href="#storage-configuration" title="Permalink to this headline">¶</a></h3>
<p>Download the Sample Configuration:</p>
<blockquote>
<div><a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;master-01">ubuntu<span>&#64;</span>master-01</a>:~$ mkdir vsms
<a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;master-01">ubuntu<span>&#64;</span>master-01</a>:~$ cd vsms/
<a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;master-01">ubuntu<span>&#64;</span>master-01</a>:~/vsms$ wget <a class="reference external" href="https://raw.githubusercontent.com/openebs/maya/master/demo/jobs/demo-vsm1.hcl">https://raw.githubusercontent.com/openebs/maya/master/demo/jobs/demo-vsm1.hcl</a></div></blockquote>
<p>Modify the IP address on which the iSCSI volumes needs to be accessed by the frontend container. Provide the size and an unique name.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="p">{</span>
    <span class="n">JIVA_VOLNAME</span> <span class="o">=</span> <span class="s2">&quot;demo-vsm1-vol1&quot;</span>
    <span class="n">JIVA_VOLSIZE</span> <span class="o">=</span> <span class="s2">&quot;10g&quot;</span>
    <span class="n">JIVA_FRONTEND_VERSION</span> <span class="o">=</span> <span class="s2">&quot;openebs/jiva:latest&quot;</span>
    <span class="n">JIVA_FRONTEND_NETWORK</span> <span class="o">=</span> <span class="s2">&quot;host_static&quot;</span>
    <span class="n">JIVA_FRONTENDIP</span> <span class="o">=</span> <span class="s2">&quot;172.28.128.101&quot;</span>
    <span class="n">JIVA_FRONTENDSUBNET</span> <span class="o">=</span> <span class="s2">&quot;24&quot;</span>
    <span class="n">JIVA_FRONTENDINTERFACE</span> <span class="o">=</span> <span class="s2">&quot;enp0s8&quot;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Similarly, customise the backend container pamameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="p">{</span>
   <span class="n">JIVA_REP_NAME</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{NOMAD_JOB_NAME}</span><span class="s2">-$</span><span class="si">{NOMAD_TASK_NAME}</span><span class="s2">&quot;</span>
   <span class="n">JIVA_CTL_IP</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{NOMAD_META_JIVA_FRONTENDIP}</span><span class="s2">&quot;</span>
   <span class="n">JIVA_REP_VOLNAME</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{NOMAD_META_JIVA_VOLNAME}</span><span class="s2">&quot;</span>
   <span class="n">JIVA_REP_VOLSIZE</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{NOMAD_META_JIVA_VOLSIZE}</span><span class="s2">&quot;</span>
   <span class="n">JIVA_REP_VOLSTORE</span> <span class="o">=</span> <span class="s2">&quot;/tmp/jiva/vsm1/rep1&quot;</span>
   <span class="n">JIVA_REP_VERSION</span> <span class="o">=</span> <span class="s2">&quot;openebs/jiva:latest&quot;</span>
   <span class="n">JIVA_REP_NETWORK</span> <span class="o">=</span> <span class="s2">&quot;host_static&quot;</span>
   <span class="n">JIVA_REP_IFACE</span> <span class="o">=</span> <span class="s2">&quot;enp0s8&quot;</span>
   <span class="n">JIVA_REP_IP</span> <span class="o">=</span> <span class="s2">&quot;172.28.128.102&quot;</span>
   <span class="n">JIVA_REP_SUBNET</span> <span class="o">=</span> <span class="s2">&quot;24&quot;</span>
   <span class="p">}</span>
</pre></div>
</div>
<p>Schedule the VSM Creation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~/vsms$ maya vsm-create demo-vsm1.hcl
==&gt;Monitoring evaluation &quot;f8917fad&quot;
   Evaluation triggered by job &quot;demo-vsm1&quot;
   Allocation &quot;59ecd70d&quot; created: node &quot;1baf7f69&quot;, group &quot;demo-vsm1-backend-container1&quot;
   Allocation &quot;d10ff4fc&quot; created: node &quot;b779de4d&quot;, group &quot;demo-vsm1-fe&quot;
   Allocation &quot;d196cfb3&quot; created: node &quot;1baf7f69&quot;, group &quot;demo-vsm1-backend-container2&quot;
   Evaluation status changed: &quot;pending&quot; -&gt; &quot;complete&quot;
   ==&gt;  Evaluation &quot;f8917fad&quot; finished with status &quot;complete&quot;
</pre></div>
</div>
<p>Check the status:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~/vsms$ maya vsm-list demo-vsm1
ID          = demo-vsm1
Name        = demo-vsm1
Type        = service
Priority    = 50
Datacenters = dc1
Status      = running
Periodic    = false

Summary
Task Group                    Queued  Starting  Running  Failed  Complete  Lost
demo-vsm1-backend-container1  0       0         1        0       0         0
demo-vsm1-backend-container2  0       0         1        0       0         0
demo-vsm1-fe                  0       0         1        0       0         0

Allocations::
ID        Eval ID   Node ID   Task Group                    Desired  Status   Created At
59ecd70d  f8917fad  1baf7f69  demo-vsm1-backend-container1  run      running  01/04/17 07:39:33 UTC
d10ff4fc  f8917fad  b779de4d  demo-vsm1-fe                  run      running  01/04/17 07:39:33 UTC
d196cfb3  f8917fad  1baf7f69  demo-vsm1-backend-container2  run      running  01/04/17 07:39:33 UTC
ubuntu@master-01:~/vsms$
</pre></div>
</div>
<p>Check the osh where the VSMs are running.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@master-01:~/vsms$ maya osh-status
ID        DC   Name     Class   Drain  Status
1baf7f69  dc1  host-02  &lt;none&gt;  false  ready
b779de4d  dc1  host-01  &lt;none&gt;  false  ready
ubuntu@master-01:~/vsms$
</pre></div>
</div>
<p>Docker status:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@host-02:~$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
openebs/jiva        latest              d3e3835763f3        11 days ago         308 MB
ubuntu@host-02:~$ docker ps
CONTAINER ID        IMAGE                 COMMAND                  CREATED             STATUS              PORTS               NAMES
2427c7a510bb        openebs/jiva:latest   &quot;launch controller --&quot;   57 seconds ago      Up 51 seconds                           demo-vsm1-ctl
c01ce8d57dd8        openebs/jiva:latest   &quot;launch replica --fro&quot;   57 seconds ago      Up 51 seconds                           demo-vsm1-rep-store1
ubuntu@host-02:~$
Next  Previous
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuring-docker-with-openebs-storage">
<h2>Configuring Docker with OpenEBS Storage<a class="headerlink" href="#configuring-docker-with-openebs-storage" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;client-01">ubuntu<span>&#64;</span>client-01</a>:~$ sudo iscsiadm -m discovery -t st -p 172.28.128.101:3260
172.28.128.101:3260,1 iqn.2016-09.com.openebs.jiva:demo1-vsm1-vol1
ubuntu&#64;client-01:~$ sudo iscsiadm -m node -l
Logging in to [iface: default, target: iqn.2016-09.com.openebs.jiva:demo1-vsm1-vol1, portal: 172.28.128.101,3260] (multiple)
Login to [iface: default, target: iqn.2016-09.com.openebs.jiva:demo1-vsm1-vol1, portal: 172.28.128.101,3260] successful.</div></blockquote>
<p>Check the block device:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ubuntu@client-01:~$ sudo iscsiadm -m session -P 3
iSCSI Transport Class version 2.0-870
version 2.0-873
Target: iqn.2016-09.com.openebs.jiva:demo1-vsm1-vol1 (non-flash)
   Attached SCSI devices:
   Host Number: 3  State: running
   scsi3 Channel 00 Id 0 Lun: 1
   Attached scsi disk sdc      State: running
   ubuntu@client-01:~$
</pre></div>
</div>
<p>Check the size</p>
<blockquote>
<div><a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;client-01">ubuntu<span>&#64;</span>client-01</a>:~$ sudo blockdev &#8211;report /dev/sdc
RO    RA   SSZ   BSZ   StartSec            Size   Device
rw   256   512  4096          0     10737418240   /dev/sdc
<a class="reference external" href="mailto:ubuntu&#37;&#52;&#48;client-01">ubuntu<span>&#64;</span>client-01</a>:~$</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Setting up Kubernetes and OpenEBS Clusters.html">Setting up Kubernetes and OpenEBS Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing Kubernetes Cluster with OpenEBS Storage.html">Testing Kubernetes Cluster with OpenEBS Storage</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/installations.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016 - 2017, CloudByte Inc.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>